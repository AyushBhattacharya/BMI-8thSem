<!DOCTYPE html>
<html>
<head>
	<title>Stage Two - Template Two</title>
	<link href="css/examples.css" rel="stylesheet" type="text/css">
	<script language="javascript" type="text/javascript" src="js/jquery.js"></script>
	<script language="javascript" type="text/javascript" src="js/jquery.flot.js"></script>
	<script type="text/javascript">
	
	var priority = [];
	$(function() 
	{
		var plot = $.plot("#placeholder", [
			{ data: priority}
		], {
			series: {
				lines: {
					show: false
				},
				points: {
					show: true
				}
			},
			grid: {
				hoverable: true,
				clickable: true
			},
			yaxis: {
				min: 0,
				max: 10
			},
			xaxis: {
				min: 0,
				max: 10
			}
		});

		$("<div id='tooltip'></div>").css({
			position: "absolute",
			display: "none",
			border: "1px solid #fdd",
			padding: "2px",
			"background-color": "#fee",
			opacity: 0.80
		}).appendTo("body");

		$("#placeholder").bind("plothover", function (event, pos, item) {
			if ($("#enableTooltip:checked").length > 0) 
			{
				if (item) 
				{
					var x = item.datapoint[0].toFixed(2),
						y = item.datapoint[1].toFixed(2);

					$("#tooltip").html(item.series.label + " of " + x + " = " + y)
						.css({top: item.pageY+5, left: item.pageX+5})
						.fadeIn(200);
				} 
				else 
				{
					$("#tooltip").hide();
				}
			}
		});

		$("#footer").prepend("Flot " + $.plot.version + " &ndash; ");
	});
	
	function init()
	{
		var mydiv = document.getElementById('mydd');
		var newnode = document.createElement('select');
		newnode.id = 'mydropdown';
		for(var i = 2131; i <= 2140; i++)
		{
			
			var newopt = document.createElement('option');
			xmlreqget = new XMLHttpRequest();
			xmlreqget.onreadystatechange = function(){
				if (xmlreqget.readyState==4 && xmlreqget.status==200)
				{
					newopt.value = xmlreqget.responseText;
					newopt.id = i;
					newopt.innerHTML = xmlreqget.responseText;
					newnode.appendChild(newopt);
					
				}
			};
			xmlreqget.open("GET","getfromdb.php?myid="+i,false);
			xmlreqget.send();
		}
		mydiv.appendChild(newnode);
	}
	
	var m = new Array();
	var f = new Array();
	var i = new Array();
	function submitpoints()
	{
		var mdd = document.getElementById('mydropdown');
		var freq = document.getElementById('frequency');
		var imp = document.getElementById('importance');
		
		m.push(mdd.value);
		f.push(freq.value);
		i.push(imp.value);
		
		mdd.removeChild(document.getElementById(mdd.options[mydropdown.selectedIndex].id));
		
		for(j = 0; j < f.length; ++j)
		{
			priority.push([f[j], i[j]]);
		}
		
		var plot = $.plot("#placeholder", [
			{ data: priority}
		], {
			series: {
				lines: {
					show: false
				},
				points: {
					show: true
				}
			},
			grid: {
				hoverable: true,
				clickable: true
			},
			yaxis: {
				min: 0,
				max: 10
			},
			xaxis: {
				min: 0,
				max: 10
			}
		});
	}
	</script>
</head>
<body onload="init()">
	<div id = "mydd"><label>Problems: </label></div>
	
	<label>Frequency:</label>
	<select id="frequency">
		<option value="0" selected>0</option>
		<option value="0.5">0.5</option>
		<option value="1">1</option>
		<option value="1.5">1.5</option>
		<option value="2">2</option>
		<option value="2.5">2.5</option>
		<option value="3">3</option>
		<option value="3.5">3.5</option>
		<option value="4">4</option>
		<option value="4.5">4.5</option>
		<option value="5">5</option>
	</select>
	
	<br/>
	<label>Importance:</label>
	<select id="importance">
		<option value="0" selected>0</option>
		<option value="0.5">0.5</option>
		<option value="1">1</option>
		<option value="1.5">1.5</option>
		<option value="2">2</option>
		<option value="2.5">2.5</option>
		<option value="3">3</option>
		<option value="3.5">3.5</option>
		<option value="4">4</option>
		<option value="4.5">4.5</option>
		<option value="5">5</option>
	</select>
	
	<br/>
	<input type="button" onclick="submitpoints()" value="Plot"/>
	<div id="content">
		<div class="demo-container">
			<div id="placeholder" class="demo-placeholder"></div>
		</div>
		<p>A tooltip is easy to build with a bit of jQuery code and the data returned from the plot.</p>
		<p><label><input id="enableTooltip" type="checkbox" checked="checked"></input>Enable tooltip</label></p>
	</div>

</body>
</html>
